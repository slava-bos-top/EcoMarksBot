print("DEBUG: executing hendlers.py FROM THIS")
print(__file__)
from aiogram.filters import CommandStart
from aiogram import Router, F
from aiogram.fsm.state import State, StatesGroup
from aiogram.fsm.context import FSMContext

from aiogram.types import (
    Message,
    InlineKeyboardMarkup,
    InlineKeyboardButton,
    CallbackQuery,
    FSInputFile,
)

import app.keyboards as kb

import os
import base64
import cv2

os.environ["TF_CPP_MIN_LOG_LEVEL"] = "2"

import tensorflow
import numpy as np
import io
from PIL import Image as PImage

router = Router()

ecoMarksImage = [
    "app/media/1.jpg",
    "app/media/2.jpg",
    "app/media/3.png",
    "app/media/4.png",
    "app/media/5.png",
    "app/media/6.png",
    "app/media/7.png",
    "app/media/8.jpg",
    "app/media/9.png",
]

ecoMarks = [
    "–ë—ñ–æ—Ä–æ–∑–∫–ª–∞–¥–Ω–∏–π",
    "–ë–ª–∞–∫–∏—Ç–Ω–∏–π –∞–Ω–≥–µ–ª (Blue Angel)",
    "–Ñ–≤—Ä–æ–ø–µ–π—Å—å–∫–∏–π –µ–∫–æ–º–∞—Ä–∫—É–≤–∞–ª—å–Ω–∏–π –∑–Ω–∞–∫ (EU Ecolabel)",
    "–°–µ—Ä—Ç–∏—Ñ—ñ–∫–∞—Ç FSC",
    "–°–∫–∞–Ω–¥–∏–Ω–∞–≤—Å—å–∫–∏–π –ª–µ–±—ñ–¥—å (Nordic Swan)",
    "–û—Ä–≥–∞–Ω—ñ—á–Ω–∏–π –ø—Ä–æ–¥—É–∫—Ç",
    "–û—Ä–≥–∞–Ω—ñ—á–Ω–∏–π –ø—Ä–æ–¥—É–∫—Ç –£–∫—Ä–∞—ó–Ω–∏",
    "–ü–µ—Ä–µ—Ä–æ–±–ª—é–≤–∞–Ω–∏–π",
    "–ó–µ–ª–µ–Ω–∏–π –∂—É—Ä–∞–≤–ª–∏–∫",
]

Info = [
    "–¢–∞–∫–µ –º–∞—Ä–∫—É–≤–∞–Ω–Ω—è —Å–≤—ñ–¥—á–∏—Ç—å, —â–æ —Ç–æ–≤–∞—Ä –∞–±–æ –π–æ–≥–æ —É–ø–∞–∫–æ–≤–∫–∞ –∑ —á–∞—Å–æ–º —Ä–æ–∑–∫–ª–∞–¥–∞—é—Ç—å—Å—è –ø—Ä–∏—Ä–æ–¥–Ω–∏–º —à–ª—è—Ö–æ–º (–±–∞–∫—Ç–µ—Ä—ñ—è–º–∏, –≥—Ä–∏–±–∞–º–∏, —ñ–Ω—à–∏–º–∏ –∂–∏–≤–∏–º–∏ –æ—Ä–≥–∞–Ω—ñ–∑–º–∞–º–∏), –Ω–µ –∑–∞–≤–¥–∞—é—á–∏ —à–∫–æ–¥–∏ –¥–æ–≤–∫—ñ–ª–ª—é. –ù–∞–ø—Ä–∏–∫–ª–∞–¥, –±—ñ–æ–ø–∞–∫–µ—Ç–∏ —á–∏ –æ–¥–Ω–æ—Ä–∞–∑–æ–≤–∏–π –ø–æ—Å—É–¥ —ñ–∑ –∫—É–∫—É—Ä—É–¥–∑—è–Ω–æ–≥–æ –∫—Ä–æ—Ö–º–∞–ª—é.",
    "–ü–µ—Ä—à–µ —É —Å–≤—ñ—Ç—ñ –µ–∫–æ–º–∞—Ä–∫—É–≤–∞–Ω–Ω—è, —Å—Ç–≤–æ—Ä–µ–Ω–µ –≤ –ù—ñ–º–µ—á—á–∏–Ω—ñ —â–µ –≤ 1978 —Ä–æ—Ü—ñ. –ô–æ–≥–æ –¥–∞—é—Ç—å —Ç–æ–≤–∞—Ä–∞–º, —è–∫—ñ –Ω–µ —à–∫–æ–¥—è—Ç—å –¥–æ–≤–∫—ñ–ª–ª—é, –∑–æ–∫—Ä–µ–º–∞ –ø–æ–±—É—Ç–æ–≤—ñ–π —Ö—ñ–º—ñ—ó, –ø–∞–ø–µ—Ä–æ–≤—ñ–π –ø—Ä–æ–¥—É–∫—Ü—ñ—ó, –µ–ª–µ–∫—Ç—Ä–æ–Ω—ñ—Ü—ñ. –¶–µ –∑–Ω–∞–∫, —â–æ –ø—Ä–æ–¥—É–∫—Ü—ñ—è –±–µ–∑–ø–µ—á–Ω—ñ—à–∞ –¥–ª—è –ø—Ä–∏—Ä–æ–¥–∏ —É –ø–æ—Ä—ñ–≤–Ω—è–Ω–Ω—ñ –∑ –∞–Ω–∞–ª–æ–≥–∞–º–∏.",
    "–û—Ñ—ñ—Ü—ñ–π–Ω–∏–π –µ–∫–æ–ª–æ–≥—ñ—á–Ω–∏–π –∑–Ω–∞–∫ –Ñ–≤—Ä–æ–ø–µ–π—Å—å–∫–æ–≥–æ –°–æ—é–∑—É. –ô–æ–≥–æ –¥–∞—é—Ç—å —Ç–æ–≤–∞—Ä–∞–º —ñ –ø–æ—Å–ª—É–≥–∞–º, —è–∫—ñ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—é—Ç—å –≤–∏—Å–æ–∫–∏–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∞–º —è–∫–æ—Å—Ç—ñ —Ç–∞ –µ–∫–æ–ª–æ–≥—ñ—á–Ω–æ—Å—Ç—ñ –Ω–∞ –≤—Å—ñ—Ö –µ—Ç–∞–ø–∞—Ö –∂–∏—Ç—Ç—î–≤–æ–≥–æ —Ü–∏–∫–ª—É: –≤—ñ–¥ –≤–∏—Ä–æ–±–Ω–∏—Ü—Ç–≤–∞ –¥–æ —É—Ç–∏–ª—ñ–∑–∞—Ü—ñ—ó. –¶–µ –º–∞—Ä–∫—É–≤–∞–Ω–Ω—è –≤–∏–∑–Ω–∞–Ω–µ –≤ —É—Å—ñ—Ö –∫—Ä–∞—ó–Ω–∞—Ö –Ñ–°.",
    "–ó–Ω–∞–∫ –õ—ñ—Å–æ–≤–æ—ó –æ–ø—ñ–∫—É–Ω—Å—å–∫–æ—ó —Ä–∞–¥–∏ (Forest Stewardship Council). –í—ñ–Ω –≥–∞—Ä–∞–Ω—Ç—É—î, —â–æ –¥–µ—Ä–µ–≤–∏–Ω–∞ —á–∏ –ø–∞–ø—ñ—Ä –≤–∏–≥–æ—Ç–æ–≤–ª–µ–Ω—ñ –∑ –ª—ñ—Å—ñ–≤, –¥–µ –≤–∏—Ä—É–±–∫–∞ –≤—ñ–¥–±—É–≤–∞—î—Ç—å—Å—è –≤—ñ–¥–ø–æ–≤—ñ–¥–∞–ª—å–Ω–æ: –≤–∏—Å–∞–¥–∂—É—é—Ç—å—Å—è –Ω–æ–≤—ñ –¥–µ—Ä–µ–≤–∞, –∑–±–µ—Ä—ñ–≥–∞—î—Ç—å—Å—è –±—ñ–æ—Ä—ñ–∑–Ω–æ–º–∞–Ω—ñ—Ç—Ç—è —ñ –≤—Ä–∞—Ö–æ–≤—É—é—Ç—å—Å—è –ø—Ä–∞–≤–∞ –º—ñ—Å—Ü–µ–≤–∏—Ö –≥—Ä–æ–º–∞–¥.",
    "–û–¥–Ω–µ –∑ –Ω–∞–π–≤—ñ–¥–æ–º—ñ—à–∏—Ö —É —Å–≤—ñ—Ç—ñ –µ–∫–æ–º–∞—Ä–∫—É–≤–∞–Ω—å, —â–æ –¥—ñ—î —É –∫—Ä–∞—ó–Ω–∞—Ö –ü—ñ–≤–Ω—ñ—á–Ω–æ—ó –Ñ–≤—Ä–æ–ø–∏ (–®–≤–µ—Ü—ñ—è, –ù–æ—Ä–≤–µ–≥—ñ—è, –§—ñ–Ω–ª—è–Ω–¥—ñ—è, –î–∞–Ω—ñ—è, –Ü—Å–ª–∞–Ω–¥—ñ—è). –ì–∞—Ä–∞–Ω—Ç—É—î, —â–æ –ø—Ä–æ–¥—É–∫—Ü—ñ—è –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î –∂–æ—Ä—Å—Ç–∫–∏–º –µ–∫–æ–ª–æ–≥—ñ—á–Ω–∏–º –≤–∏–º–æ–≥–∞–º: –Ω–∏–∑—å–∫–∏–π –≤–ø–ª–∏–≤ –Ω–∞ –ø—Ä–∏—Ä–æ–¥—É, –±–µ–∑–ø–µ—á–Ω—ñ—Å—Ç—å –¥–ª—è –∑–¥–æ—Ä–æ–≤‚Äô—è –ª—é–¥–∏–Ω–∏ —Ç–∞ –∫–æ–Ω—Ç—Ä–æ–ª—å —è–∫–æ—Å—Ç—ñ –Ω–∞ –≤—Å—ñ—Ö –µ—Ç–∞–ø–∞—Ö –≤–∏—Ä–æ–±–Ω–∏—Ü—Ç–≤–∞.",
    "–¶–µ –º–∞—Ä–∫—É–≤–∞–Ω–Ω—è –ø–æ–∫–∞–∑—É—î, —â–æ –ø—Ä–æ–¥—É–∫—Ç –≤–∏—Ä–æ—â–µ–Ω–∏–π –±–µ–∑ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è —Ö—ñ–º—ñ—á–Ω–∏—Ö –¥–æ–±—Ä–∏–≤, –ø–µ—Å—Ç–∏—Ü–∏–¥—ñ–≤, –ì–ú–û —á–∏ —Å–∏–Ω—Ç–µ—Ç–∏—á–Ω–∏—Ö –¥–æ–±–∞–≤–æ–∫. –í–æ–Ω–æ –ø–æ—à–∏—Ä–µ–Ω–µ —É —Å–≤—ñ—Ç—ñ –Ω–∞ –ø—Ä–æ–¥—É–∫—Ç–∞—Ö —Ö–∞—Ä—á—É–≤–∞–Ω–Ω—è, –∫–æ—Å–º–µ—Ç–∏—Ü—ñ —Ç–∞ —Ç–µ–∫—Å—Ç–∏–ª—ñ.",
    "–ù–∞—Ü—ñ–æ–Ω–∞–ª—å–Ω–µ —É–∫—Ä–∞—ó–Ω—Å—å–∫–µ –º–∞—Ä–∫—É–≤–∞–Ω–Ω—è –¥–ª—è –æ—Ä–≥–∞–Ω—ñ—á–Ω–∏—Ö –ø—Ä–æ–¥—É–∫—Ç—ñ–≤. –ô–æ–≥–æ –¥–∞—é—Ç—å —Ç–æ–≤–∞—Ä–∞–º, —â–æ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—é—Ç—å —î–≤—Ä–æ–ø–µ–π—Å—å–∫–∏–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∞–º –æ—Ä–≥–∞–Ω—ñ—á–Ω–æ–≥–æ –≤–∏—Ä–æ–±–Ω–∏—Ü—Ç–≤–∞, –∞–ª–µ —Å–µ—Ä—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—é –ø—Ä–æ—Ö–æ–¥—è—Ç—å —Å–∞–º–µ –≤ –£–∫—Ä–∞—ó–Ω—ñ. –¶–µ –¥–æ–ø–æ–º–∞–≥–∞—î —Å–ø–æ–∂–∏–≤–∞—á–∞–º –≤–ø—ñ–∑–Ω–∞–≤–∞—Ç–∏ –Ω–∞—Ç—É—Ä–∞–ª—å–Ω—ñ —Ç–∞ –±–µ–∑–ø–µ—á–Ω—ñ –ø—Ä–æ–¥—É–∫—Ç–∏ –Ω–∞ —Ä–∏–Ω–∫—É.",
    "–ü–æ–∫–∞–∑—É—î, —â–æ —É–ø–∞–∫–æ–≤–∫—É –∞–±–æ —Ç–æ–≤–∞—Ä –º–æ–∂–Ω–∞ –∑–¥–∞—Ç–∏ –Ω–∞ –ø–µ—Ä–µ—Ä–æ–±–∫—É. –¶–µ –¥–æ–ø–æ–º–∞–≥–∞—î –∑–º–µ–Ω—à–∏—Ç–∏ –∫—ñ–ª—å–∫—ñ—Å—Ç—å –≤—ñ–¥—Ö–æ–¥—ñ–≤ —Ç–∞ –ø–æ–≤—Ç–æ—Ä–Ω–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ —Ä–µ—Å—É—Ä—Å–∏. –ó–∞–∑–≤–∏—á–∞–π –º–∞—Ä–∫—É–≤–∞–Ω–Ω—è –º–∞—î –≤–∏–≥–ª—è–¥ —Ç—Ä–∏–∫—É—Ç–Ω–∏–∫–∞ –∑—ñ —Å—Ç—Ä—ñ–ª–æ–∫.",
    "–£–∫—Ä–∞—ó–Ω—Å—å–∫–µ –¥–æ–±—Ä–æ–≤—ñ–ª—å–Ω–µ –µ–∫–æ–ª–æ–≥—ñ—á–Ω–µ –º–∞—Ä–∫—É–≤–∞–Ω–Ω—è. –ô–æ–≥–æ –æ—Ç—Ä–∏–º—É—é—Ç—å —Ç–æ–≤–∞—Ä–∏, —â–æ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—é—Ç—å –µ–∫–æ–ª–æ–≥—ñ—á–Ω–∏–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∞–º: –±–µ–∑–ø–µ—á–Ω—ñ —É –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—ñ, –≤–∏–≥–æ—Ç–æ–≤–ª–µ–Ω—ñ –∑ –º—ñ–Ω—ñ–º–∞–ª—å–Ω–∏–º –≤–ø–ª–∏–≤–æ–º –Ω–∞ –ø—Ä–∏—Ä–æ–¥—É, –º–æ–∂—É—Ç—å –ø–µ—Ä–µ—Ä–æ–±–ª—è—Ç–∏—Å—è. –¶–µ –∑–Ω–∞–∫ –¥–æ–≤—ñ—Ä–∏ –¥–ª—è —Å–ø–æ–∂–∏–≤–∞—á—ñ–≤, —è–∫—ñ —Ö–æ—á—É—Ç—å –æ–±–∏—Ä–∞—Ç–∏ –±—ñ–ª—å—à –µ–∫–æ–ª–æ–≥—ñ—á–Ω—ñ —Ç–æ–≤–∞—Ä–∏ –Ω–∞ —É–∫—Ä–∞—ó–Ω—Å—å–∫–æ–º—É —Ä–∏–Ω–∫—É.",
]

models = tensorflow.keras.models.load_model(
    "app/media/eco_marks_model.keras", compile=False
)


class Register(StatesGroup):
    photo = State()


@router.callback_query(
    F.data.in_(
        [
            "next0",
            "next1",
            "next2",
            "next3",
            "next4",
            "next5",
            "next6",
            "next7",
            "next8",
            "next9",
        ]
    )
)
async def callback(callback: CallbackQuery):
    index = int(callback.data.replace("next", ""))
    await callback.message.answer(text=f"{ecoMarks[index]}")
    await callback.message.answer(text=f"{Info[index]}")


@router.message(CommandStart())
async def start(message: Message):
    await message.answer(
        "üëã –í—ñ—Ç–∞—é!\n–¶–µ –±–æ—Ç, —è–∫–∏–π –¥–æ–ø–æ–º–æ–∂–µ —Ä–æ–∑–ø—ñ–∑–Ω–∞—Ç–∏ –µ–∫–æ–ª–æ–≥—ñ—á–Ω—ñ –º–∞—Ä–∫—É–≤–∞–Ω–Ω—è –Ω–∞ —É–ø–∞–∫–æ–≤–∫–∞—Ö üåç\nüì∏ –ü—Ä–æ—Å—Ç–æ –∑—Ä–æ–±–∏ —Ñ–æ—Ç–æ –ª–æ–≥–æ—Ç–∏–ø—É —á–∏ –∑–Ω–∞–∫—É –Ω–∞ —Ç–æ–≤–∞—Ä—ñ ‚Äî —ñ –±–æ—Ç –ø—ñ–¥–∫–∞–∂–µ:\n‚úÖ —â–æ —Ü–µ –∑–∞ –µ–∫–æ–º–∞—Ä–∫—É–≤–∞–Ω–Ω—è\n‚úÖ —â–æ –≤–æ–Ω–æ –æ–∑–Ω–∞—á–∞—î\n‚úÖ —è–∫ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –ø–æ–≤–æ–¥–∏—Ç–∏—Å—è –∑ —Ü–∏–º —Ç–æ–≤–∞—Ä–æ–º –∞–±–æ —É–ø–∞–∫–æ–≤–∫–æ—é\n\n–¢–∞–∫ —Ç–∏ –∑–º–æ–∂–µ—à —à–≤–∏–¥–∫–æ –¥—ñ–∑–Ω–∞—Ç–∏—Å—è, —á–∏ –º–æ–∂–Ω–∞ —É–ø–∞–∫–æ–≤–∫—É –ø–µ—Ä–µ—Ä–æ–±–∏—Ç–∏, —á–∏ —Ç–æ–≤–∞—Ä —î –æ—Ä–≥–∞–Ω—ñ—á–Ω–∏–º, —á–∏ –≤—ñ–Ω –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î –º—ñ–∂–Ω–∞—Ä–æ–¥–Ω–∏–º –µ–∫–æ—Å—Ç–∞–Ω–¥–∞—Ä—Ç–∞–º üåø‚ôªÔ∏è\n\nüí° –û–±–∏—Ä–∞–π —Å–≤—ñ–¥–æ–º–æ ‚Äî —Ä–æ–±–∏ —Å–≤—ñ–π –≤–Ω–µ—Å–æ–∫ —É –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è –ø—Ä–∏—Ä–æ–¥–∏!",
        reply_markup=kb.main,
    )


@router.message(F.text == "üåø –î—ñ–∑–Ω–∞—Ç–∏—Å—è –±—ñ–ª—å—à–µ –ø—Ä–æ –µ–∫–æ–º–∞—Ä–∫—É–≤–∞–Ω–Ω—è")
async def Information(message: Message):
    await message.answer(
        "üå± –ï–∫–æ–º–∞—Ä–∫—É–≤–∞–Ω–Ω—è ‚Äî —Ü–µ —Å–ø–µ—Ü—ñ–∞–ª—å–Ω—ñ –∑–Ω–∞–∫–∏ –Ω–∞ —Ç–æ–≤–∞—Ä–∞—Ö —ñ —É–ø–∞–∫–æ–≤–∫–∞—Ö, —è–∫—ñ –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂—É—é—Ç—å, —â–æ –ø—Ä–æ–¥—É–∫—Ü—ñ—è —î –±—ñ–ª—å—à –±–µ–∑–ø–µ—á–Ω–æ—é –¥–ª—è –¥–æ–≤–∫—ñ–ª–ª—è —Ç–∞ –ª—é–¥–∏–Ω–∏. –í–æ–Ω–∏ –≤–∫–∞–∑—É—é—Ç—å, —â–æ —Ç–æ–≤–∞—Ä –≤–∏–≥–æ—Ç–æ–≤–ª–µ–Ω–∏–π –∑ –¥–æ—Ç—Ä–∏–º–∞–Ω–Ω—è–º –µ–∫–æ–ª–æ–≥—ñ—á–Ω–∏—Ö —Å—Ç–∞–Ω–¥–∞—Ä—Ç—ñ–≤, –º–æ–∂–µ –±—É—Ç–∏ –ø–µ—Ä–µ—Ä–æ–±–ª–µ–Ω–∏–π, –º–∞—î –º–µ–Ω—à–∏–π –≤—É–≥–ª–µ—Ü–µ–≤–∏–π —Å–ª—ñ–¥ –∞–±–æ –∂ –≤–∏–≥–æ—Ç–æ–≤–ª–µ–Ω–∏–π —ñ–∑ –Ω–∞—Ç—É—Ä–∞–ª—å–Ω–∏—Ö –º–∞—Ç–µ—Ä—ñ–∞–ª—ñ–≤.\n\n–ï–∫–æ–º–∞—Ä–∫—É–≤–∞–Ω–Ω—è –¥–æ–ø–æ–º–∞–≥–∞—î —Å–ø–æ–∂–∏–≤–∞—á–∞–º —Ä–æ–±–∏—Ç–∏ —Å–≤—ñ–¥–æ–º–∏–π –≤–∏–±—ñ—Ä: –æ–±–∏—Ä–∞—é—á–∏ —Ç–æ–≤–∞—Ä–∏ –∑ —Ç–∞–∫–∏–º–∏ –ø–æ–∑–Ω–∞—á–∫–∞–º–∏, –ª—é–¥–∏–Ω–∞ –ø—ñ–¥—Ç—Ä–∏–º—É—î –∫–æ–º–ø–∞–Ω—ñ—ó, —è–∫—ñ –ø—ñ–∫–ª—É—é—Ç—å—Å—è –ø—Ä–æ –¥–æ–≤–∫—ñ–ª–ª—è. –í–æ–¥–Ω–æ—á–∞—Å –≤–æ–Ω–æ –º–æ—Ç–∏–≤—É—î –≤–∏—Ä–æ–±–Ω–∏–∫—ñ–≤ –∑–º–µ–Ω—à—É–≤–∞—Ç–∏ —à–∫–æ–¥—É –ø—Ä–∏—Ä–æ–¥—ñ, –≤–ø—Ä–æ–≤–∞–¥–∂—É–≤–∞—Ç–∏ –Ω–æ–≤—ñ —Ç–µ—Ö–Ω–æ–ª–æ–≥—ñ—ó —Ç–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ —Ä–µ—Å—É—Ä—Å–∏ –±—ñ–ª—å—à –≤—ñ–¥–ø–æ–≤—ñ–¥–∞–ª—å–Ω–æ.\n\n–ù–∞–π–ø–æ—à–∏—Ä–µ–Ω—ñ—à—ñ —Ç–∏–ø–∏ –µ–∫–æ–º–∞—Ä–∫—É–≤–∞–Ω—å:\n\n‚ôªÔ∏è –ü–µ—Ä–µ—Ä–æ–±–∫–∞ —Ç–∞ –ø–æ–≤—Ç–æ—Ä–Ω–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è ‚Äî –∑–Ω–∞–∫ –ø–æ–∫–∞–∑—É—î, —â–æ —É–ø–∞–∫–æ–≤–∫–∞ —á–∏ –º–∞—Ç–µ—Ä—ñ–∞–ª –ø—ñ–¥–ª—è–≥–∞—é—Ç—å –≤—Ç–æ—Ä–∏–Ω–Ω—ñ–π –ø–µ—Ä–µ—Ä–æ–±—Ü—ñ –∞–±–æ –≤–∏–≥–æ—Ç–æ–≤–ª–µ–Ω—ñ –∑ –ø–µ—Ä–µ—Ä–æ–±–ª–µ–Ω–æ—ó —Å–∏—Ä–æ–≤–∏–Ω–∏.\n\nüåø –û—Ä–≥–∞–Ω—ñ—á–Ω—ñ—Å—Ç—å ‚Äî –ø—Ä–æ–¥—É–∫—Ü—ñ—è –≤–∏—Ä–æ—â–µ–Ω–∞ –±–µ–∑ —Ö—ñ–º—ñ—á–Ω–∏—Ö –¥–æ–±—Ä–∏–≤, –ø–µ—Å—Ç–∏—Ü–∏–¥—ñ–≤ —á–∏ –ì–ú–û (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, Organic –∞–±–æ Organic UA).\n\nüåç –ú—ñ–∂–Ω–∞—Ä–æ–¥–Ω—ñ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∏ ‚Äî —Ç–∞–∫—ñ —è–∫ EU Ecolabel, Nordic Swan, Blue Angel, —è–∫—ñ –≥–∞—Ä–∞–Ω—Ç—É—é—Ç—å –µ–∫–æ–ª–æ–≥—ñ—á–Ω—ñ—Å—Ç—å –Ω–∞ —Ä—ñ–∑–Ω–∏—Ö –µ—Ç–∞–ø–∞—Ö –≤–∏—Ä–æ–±–Ω–∏—Ü—Ç–≤–∞.\n\nüå≥ –°—Ç–∞–ª–∏–π —Ä–æ–∑–≤–∏—Ç–æ–∫ ‚Äî –Ω–∞–ø—Ä–∏–∫–ª–∞–¥, FSC, —â–æ –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂—É—î –≤—ñ–¥–ø–æ–≤—ñ–¥–∞–ª—å–Ω–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –ª—ñ—Å—ñ–≤.\n\n–¢–∞–∫–∏–º —á–∏–Ω–æ–º, –µ–∫–æ–º–∞—Ä–∫—É–≤–∞–Ω–Ω—è ‚Äî —Ü–µ –ø—Ä–æ–≤—ñ–¥–Ω–∏–∫ –º—ñ–∂ –≤–∏—Ä–æ–±–Ω–∏–∫–æ–º —ñ –ø–æ–∫—É–ø—Ü–µ–º, —è–∫–∏–π –¥–æ–∑–≤–æ–ª—è—î –∑—Ä–æ–∑—É–º—ñ—Ç–∏, –Ω–∞—Å–∫—ñ–ª—å–∫–∏ —Ç–æ–≤–∞—Ä –¥—Ä—É–∂–Ω—ñ–π –¥–æ –ø—Ä–∏—Ä–æ–¥–∏. –û–±–∏—Ä–∞—é—á–∏ –ø—Ä–æ–¥—É–∫—Ü—ñ—é –∑ –µ–∫–æ–∑–Ω–∞–∫–∞–º–∏, –º–∏ –Ω–µ –ª–∏—à–µ –¥–±–∞—î–º–æ –ø—Ä–æ –≤–ª–∞—Å–Ω–µ –∑–¥–æ—Ä–æ–≤‚Äô—è, –∞ –π —Ä–æ–±–∏–º–æ –≤–Ω–µ—Å–æ–∫ —É –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è –¥–æ–≤–∫—ñ–ª–ª—è –¥–ª—è –º–∞–π–±—É—Ç–Ω—ñ—Ö –ø–æ–∫–æ–ª—ñ–Ω—å.",
        reply_markup=kb.main,
        parse_mode="html",
    )


@router.message(F.text == "‚ôªÔ∏è –û–±—Ä–∞—Ç–∏ –µ–∫–æ–º–∞—Ä–∫—É–≤–∞–Ω–Ω—è")
async def TakePhoto(message: Message):
    for i in range(0, 9):
        image = FSInputFile(ecoMarksImage[i])
        text = ecoMarks[i]
        k = int(i) + 1
        keyboard = InlineKeyboardMarkup(
            inline_keyboard=[
                [InlineKeyboardButton(text=f"–¶–µ —Ñ–æ—Ç–æ", callback_data=f"next{i}")]
            ]
        )
        await message.answer_photo(
            photo=image,
            caption=text,
            parse_mode="HTML",
            reply_markup=keyboard,
        )
    await message.answer("–û–±–µ—Ä—ñ—Ç—å –∫–∞—Ä—Ç–∏–Ω–∫—É")


@router.message(F.text == "üì∏ –ó—Ä–æ–±–∏—Ç–∏ —Ñ–æ—Ç–æ –º–∞—Ä–∫—É–≤–∞–Ω–Ω—è")
async def register_name(message: Message, state: FSMContext):
    await state.set_state(Register.photo)
    await message.answer("–í—ñ–¥–ø—Ä–∞–≤—Ç–µ —Ñ–æ—Ç–æ")


@router.message(Register.photo, F.photo)
async def register_city(message: Message, state: FSMContext):
    await message.answer("–ê–Ω–∞–ª—ñ–∑—É—é —Ñ–æ—Ç–æ...")
    photo = message.photo[-1]

    # –∑–∞–≤–∞–Ω—Ç–∞–∂—É—î–º–æ —Ñ–∞–π–ª –∑ Telegram
    file = await message.bot.get_file(photo.file_id)
    downloaded_file = await message.bot.download_file(file.file_path)
    image_data = downloaded_file.read()

    # –≤—ñ–¥–∫—Ä–∏–≤–∞—î–º–æ –∫–∞—Ä—Ç–∏–Ω–∫—É
    imgpath = PImage.open(io.BytesIO(image_data)).convert("RGB")
    loadedImages = np.asarray(imgpath)
    resized_image = cv2.resize(loadedImages, (240, 240))
    loadedImages = resized_image / 255.0
    y = np.expand_dims(loadedImages, axis=0)

    # –ø–µ—Ä–µ–¥–±–∞—á–µ–Ω–Ω—è
    res = models.predict(y)

    all_parametrs = list(res[0])

    sorted_list = []
    for n in range(5):
        max_val = max(all_parametrs)
        max_idx = all_parametrs.index(max_val)
        sorted_list.append(max_val)
        sorted_list.append(max_idx)
        all_parametrs[max_idx] = 0

    data = {
        "first": sorted_list[0],
        "firstIndex": sorted_list[1],
        "second": sorted_list[2],
        "secondIndex": sorted_list[3],
        "third": sorted_list[4],
        "thirdIndex": sorted_list[5],
        "fourth": sorted_list[6],
        "fourthIndex": sorted_list[7],
        "fifth": sorted_list[8],
        "fifthIndex": sorted_list[9],
    }

    print(data)
    await message.answer(f"{ecoMarks[sorted_list[1]]}")
    await message.answer(f"{Info[sorted_list[1]]}")
    await state.clear()

